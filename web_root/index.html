<!DOCTYPE html>
<html>
<head>
	<title>Vmanager GUI</title>
	<link rel="stylesheet" type="text/css" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css">
	<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro&display=swap" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="/vmanager-gui.css">
	<script type="text/javascript">
		let socket = null;

		let xhr = new XMLHttpRequest();
		xhr.open("GET", 'https://raw.githubusercontent.com/Torxed/slimWebSocket/master/slimWebSocket.js', true);
		xhr.onreadystatechange = function() {
			if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {
				let script = document.createElement('script');
				script.type = 'text/javascript';
				script.innerHTML = this.responseText;
				document.head.appendChild(script);

				socket = new slimWebSocket('wss://127.0.0.1');
			}
		}
		xhr.send();
	</script>
	<script src="/vmanager.js"></script>
	<script src="/vmanager-gui.js"></script>
	<script type="text/javascript">
		window.onload = function() {
			let loader = setInterval(() => {
				console.log('moo')
				if(socket) {
					socket.clear_subscribers();
					let view = new overview(document.querySelector('.body'));

					view_machines();

					clearInterval(loader);
				}
			}, 200)

			document.querySelector('#btn_overview').addEventListener('click', (event) => {
				resource_handlers = {};
				let view = new overview(document.querySelector('.body'));

				view_machines();
			})

			document.querySelector('#btn_machines').addEventListener('click', (event) => {
				socket.clear_subscribers();
				let view = new machines(document.querySelector('.body'));

				view_machines(true);
			})

			document.querySelector('#btn_network').addEventListener('click', (event) => {
				socket.clear_subscribers();
				let view = new networkinterfaces(document.querySelector('.body'));

				view_nics(true);
			})

			let x = [
				"https://img.shields.io/github/languages/code-size/Torxed/Vmanager-gui",
				"https://img.shields.io/github/downloads/Torxed/Vmanager-gui/total",
				"https://img.shields.io/github/languages/top/Torxed/Vmanager-gui",
				"https://img.shields.io/badge/python-3%2B-blue"
			].forEach((url) => {
				let img = document.createElement('img');
				img.src = url;
				document.querySelector('#footer_links').appendChild(img);
			})
		}
	</script>
</head>
<body>
	<div class="container">
		<div class="header">
			<div class="stylebar">Vmanager v0.1</div>
			<div class="menu">
				<div class="logo"></div>

				<div class="button" id="btn_overview">Overview</div>
				<div class="button" id="btn_machines">Machines</div>
				<div class="button" id="btn_network">Network</div>
				<div class="button" id="btn_resources">Resources</div>
				<div class="button right" id="btn_editor">Graphical Editor</div>
			</div>
		</div>
		<div class="body">
			
		</div>
		<div class="footer">
			<a href="https://github.com/Torxed/Vmanager-gui" id="footer_links">
				
			</a>
		</div>
	</div>
</body>
</html>